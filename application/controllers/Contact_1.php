<?php if (!defined('BASEPATH')) exit('No direct script access allowed');class Contact extends MY_Controller{    public $data = array();    public function __construct()    {        parent::__construct();        date_default_timezone_set('UTC');        $this->load->model(array(            'web/Model_label',            'web/Model_content',            'web/Model_register'        ));        $this->load->helper(array(            'funcglobal',            'menu',            'accessprivilege',            'alias',            'url',            'email'        ));        $this->data['controller'] = $this->uri->segment(1);          $this->data["menu_id"]='6';         $this->data["module_header"]=131;                $string = $this->data["module_header"];                $arrayin=array_map('intval', explode(',', $string));                $this->data["where_in"] = implode(",",$arrayin);                $this->data['now'] = date("Y-m-d");	           	}        public function language()	{		$id = $this->uri->segment(2);		$_SESSION['language'] = $id;		if(isset($_SERVER['HTTP_REFERER'])) {                $_SERVER['HTTP_REFERER'];}               		if(empty($_SERVER['HTTP_REFERER'])){			$direct = BASE_URL.'/home';		} else {			$direct = $_SERVER['HTTP_REFERER'];		}		redirect($direct);	}        	public function index()	{                      $ListHeader =array();                           $order_limit='';                $order_limit .= " order by a.row_order ASC";                             $label_page =1;                $whereContent = '';                $whereContent .= " WHERE a.row_active_status=1 and a.row_active_status=1 and a.row_parent=0 and a.module_id in(".$this->data["where_in"].") ";                               $ListHeader = $this->Model_content->getListContent($whereContent,$order_limit,$label_page);                $this->data["countHeader"] = count($ListHeader);		$this->data["ListHeader"] = $ListHeader;                                        $this->load->view('vcontact',$this->data);	}    function postMsg()    {        if(isset($_POST['g-recaptcha-response']) && isset($_POST['captcha'])){            //your site secret key        $secret         = SECRET_KEY;    $response = "";    $response = file_get_contents("https://www.google.com/recaptcha/api/siteverify?secret=".$secret."&response=".$_POST['g-recaptcha-response']."&remoteip=".$_SERVER['REMOTE_ADDR']);    $response = json_decode( $response , true );    if($response['success'] == false)    {        echo $recaptchaErrorMessage;        exit;    }else{      unset($_POST['g-recaptcha-response']);    }    $this->load->library('email');  $this->email->initialize(array(          'protocol' => 'smtp',          'smtp_host' => 'smtp.sendgrid.net',          'smtp_user' => 'Selangitstudio',          'smtp_pass' => 'instagramkayamuda8T',          'smtp_port' => 587,          'crlf' => "\r\n",          'newline' => "\r\n"        ));                       $name           = $this->security->xss_clean(trim($_POST['fname']));            $email          = $this->security->xss_clean(trim($_POST['email']));            $subject          = $this->security->xss_clean(trim($_POST['subject']));            $phone         = $this->security->xss_clean(trim($_POST['phone']));            $message        = $this->security->xss_clean(trim($_POST['message']));            // Insert user record              $subjects        = 'contact form -' .$subject;            $message_email = '<p>From</p>';            $message_email .= 'Name : ' . $name . '<br/>';            $message_email .= 'Email : ' . $email . ' <br/>';            $message_email .= 'Phone : ' . $phone . '<br/>';            $message_email .= 'Messages : ' . $message . ' <br/>';            $this->email->from('selangitstudio@gmail.com');            $this->email->to(MAIL_CT);            $this->email->cc(MAIL_CC);			$this->email->bcc(MAIL_BCC);            $this->email->subject($subjects);            $this->email->message($message_email);            $this->email->send();//echo $message_email;            $this->email->print_debugger();            $result = 5;                    } else {            $result = 5;        }        echo json_encode($result);    } }